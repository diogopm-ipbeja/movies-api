openapi: 3.1.1
info:
  title: Movies API
  version: 1.0.0
  description: REST API for managing movies, genres, people, and users including ratings, favorites, and related media resources.
paths:
  /failures:
    get:
      summary: Get simulated failure settings
      description: Returns the current configuration for simulating failures, including error rate and artificial latency.
      responses:
        "200":
          description: Current failure simulation configuration.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SimulateFailuresConfig"
    put:
      summary: Update simulated failure settings
      description: Updates the configuration that controls artificial failures and delays, typically used for testing resilience in client applications.
      requestBody:
        description: New failure simulation parameters.
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SimulateFailuresConfig"
      responses:
        "204":
          description: Failure simulation configuration updated successfully.
  /genres:
    get:
      summary: List all genres
      description: Returns all available movie genres with identifiers, names, and descriptions for use when categorizing movies.
      responses:
        "200":
          description: List of genres.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/GenreResponse"
    post:
      summary: Create genres
      description: Creates one or more new genres that can be assigned to movies, returning the persisted genre records. Requires basic authentication.
      security:
        - basic: []
      requestBody:
        description: One or more genre objects to create.
        required: true
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: "#/components/schemas/CreateGenreRequest"
      responses:
        "200":
          description: Created genres.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/GenreResponse"
    put:
      summary: Update a genre
      description: Updates an existing genre’s basic attributes such as name and description. Requires basic authentication.
      security:
        - basic: []
      requestBody:
        description: Updated genre data.
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateGenreRequest"
      responses:
        "200":
          description: Updated genre.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GenreResponse"
  /genres/{id}:
    delete:
      summary: Delete a genre
      description: Deletes a single genre identified by its ID, typically when it is no longer used for categorizing movies. Requires basic authentication.
      security:
        - basic: []
      parameters:
        - name: id
          in: path
          required: true
          description: Unique identifier of the genre to delete.
          schema:
            type: string
      responses:
        "204":
          description: Genre deleted successfully.
  /genres/delete:
    put:
      summary: Bulk delete genres
      description: Deletes multiple genres in a single operation by accepting an array of genre IDs. Requires basic authentication.
      security:
        - basic: []
      requestBody:
        description: Array of genre IDs to delete.
        required: true
        content:
          application/json:
            schema:
              type: array
              items:
                type: integer
      responses:
        "204":
          description: Genres deleted successfully.
  /movies/{id}:
    get:
      summary: Get movie details
      description: Returns detailed information about a specific movie including genres, director, cast, pictures, rating, and timestamps.
      parameters:
        - name: id
          in: path
          required: true
          description: Unique identifier of the movie.
          schema:
            type: integer
      responses:
        "200":
          description: Detailed movie information.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MovieDetailResponse"
    delete:
      summary: Delete a movie
      description: Deletes a movie and its associated metadata such as cast and pictures. Requires basic authentication.
      parameters:
        - name: id
          in: path
          required: true
          description: Unique identifier of the movie to delete.
          schema:
            type: integer
      security:
        - basic: []
      responses:
        "204":
          description: Movie deleted successfully.
  /movies/{id}/pictures/{pictureId}:
    get:
      summary: Download movie picture
      description: Returns a specific picture for the given movie, typically as binary content suitable for display in clients.
      parameters:
        - name: id
          in: path
          required: true
          description: Movie identifier that owns the picture.
          schema:
            type: integer
        - name: pictureId
          in: path
          required: true
          description: Unique identifier of the movie picture.
          schema:
            type: integer
      responses:
        "200":
          description: Requested movie picture file.
          content:
            "*/*":
              schema:
                type: string
                format: binary
    delete:
      summary: Delete movie picture
      description: Deletes a specific picture associated with a movie, freeing up storage and removing it from client listings. Requires basic authentication.
      parameters:
        - name: id
          in: path
          required: true
          description: Movie identifier that owns the picture.
          schema:
            type: integer
        - name: pictureId
          in: path
          required: true
          description: Unique identifier of the movie picture to delete.
          schema:
            type: integer
      security:
        - basic: []
      responses:
        "204":
          description: Movie picture deleted successfully.
  /movies/:
    get:
      summary: Search movies
      description: Returns a filtered and optionally paginated list of movies based on director, genre, title, release date range, rating range, favorites flag, and sorting options.
      parameters:
        - name: offset
          in: query
          required: false
          description: Zero-based index of the first item to return.
          schema:
            type: integer
        - name: count
          in: query
          required: false
          description: Maximum number of movies to return.
          schema:
            type: integer
        - name: director
          in: query
          required: false
          description: Director ID to filter movies by director.
          schema:
            type: integer
        - name: genre
          in: query
          required: false
          description: Genre name to filter movies.
          schema:
            type: string
        - name: title
          in: query
          required: false
          description: Partial or full movie title to search for.
          schema:
            type: string
        - name: fromReleaseDate
          in: query
          required: false
          description: "Start of release date range filter. Format: YYYY-MM-DD."
          schema:
            type: string
            format: date
        - name: toReleaseDate
          in: query
          required: false
          description: "End of release date range filter. Format: YYYY-MM-DD."
          schema:
            type: string
            format: date
        - name: fromRating
          in: query
          required: false
          description: Minimum average rating filter.
          schema:
            type: integer
        - name: toRating
          in: query
          required: false
          description: Maximum average rating filter.
          schema:
            type: integer
        - name: favoritesOnly
          in: query
          required: false
          description: Whether to return only movies marked as favorites by the user.
          schema:
            type: boolean
        - name: sortBy
          in: query
          required: false
          description: Field used to sort the result set, such as title or releaseDate.
          schema:
            type: string
        - name: sortOrder
          in: query
          required: false
          description: Sort order direction, for example ASC or DESC.
          schema:
            type: string
      responses:
        "200":
          description: List of movies matching the filter criteria.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/MovieQueryResponse"
    put:
      summary: Bulk update movies (reserved)
      description: Reserved endpoint for updating movie collections in bulk; behavior may be extended in the future. Requires basic authentication.
      security:
        - basic: []
      responses:
        "204":
          description: Movies updated successfully or no content returned.
  /movies/{id}/ratings:
    get:
      summary: List ratings for a movie
      description: Returns all user ratings for a given movie, including scores, comments, and author identifiers.
      parameters:
        - name: id
          in: path
          required: true
          description: Identifier of the movie whose ratings are requested.
          schema:
            type: integer
      responses:
        "200":
          description: List of ratings for the movie.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/MovieRatingResponse"
    post:
      summary: Set or update user rating
      description: Creates or updates the rating of the authenticated user for the given movie, including optional comment text. Requires basic authentication.
      security:
        - basic: []
      parameters:
        - name: id
          in: path
          required: true
          description: Identifier of the movie being rated.
          schema:
            type: string
      requestBody:
        description: Rating score and optional comment.
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SetUserRatingRequest"
      responses:
        "204":
          description: Rating stored successfully.
    delete:
      summary: Remove user rating
      description: Deletes the authenticated user’s rating for the given movie so that it no longer contributes to the aggregate score. Requires basic authentication.
      security:
        - basic: []
      parameters:
        - name: id
          in: path
          required: true
          description: Identifier of the movie whose rating is removed.
          schema:
            type: string
      responses:
        "204":
          description: Rating removed successfully.
  /movies/{id}/mark-as-favorite:
    put:
      summary: Mark or unmark movie as favorite
      description: Marks a movie as a favorite or removes it from favorites for the authenticated user, depending on the provided value. Requires basic authentication.
      security:
        - basic: []
      parameters:
        - name: id
          in: path
          required: true
          description: Identifier of the movie to modify favorite state.
          schema:
            type: string
        - name: value
          in: query
          required: false
          description: Boolean-like flag indicating whether to mark (true) or unmark (false) the movie as favorite; may default to true if omitted.
          schema:
            type: string
      responses:
        "204":
          description: Favorite flag updated successfully.
  /movies:
    post:
      summary: Create movies
      description: Creates one or more movies with associated metadata such as genres, director, cast, and pictures, returning the full created records. Requires basic authentication.
      security:
        - basic: []
      requestBody:
        description: Array of movies to create.
        required: true
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: "#/components/schemas/CreateMovieRequest"
      responses:
        "200":
          description: Created movies with full details.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/MovieDetailResponse"
  /movies/{id}/cast:
    post:
      summary: Assign cast members to a movie
      description: Adds or replaces cast assignments for the given movie, associating people with character roles. Requires basic authentication.
      security:
        - basic: []
      parameters:
        - name: id
          in: path
          required: true
          description: Identifier of the movie to which cast is assigned.
          schema:
            type: string
      requestBody:
        description: List of cast member assignments for the movie.
        required: true
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: "#/components/schemas/CastMemberAssignmentRequest"
      responses:
        "200":
          description: Cast members assigned to the movie.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/CastMemberResponse"
  /movies/{id}/cast/{personId}:
    delete:
      summary: Remove cast member from movie
      description: Removes a single person from the cast list of the given movie, based on the person identifier. Requires basic authentication.
      security:
        - basic: []
      parameters:
        - name: id
          in: path
          required: true
          description: Identifier of the movie.
          schema:
            type: string
        - name: personId
          in: path
          required: true
          description: Identifier of the cast member to remove.
          schema:
            type: string
      responses:
        "204":
          description: Cast member removed from movie.
  /movies/{id}/cast/remove:
    put:
      summary: Bulk remove cast members
      description: Removes multiple cast members from a movie by passing an array of cast entry identifiers. Requires basic authentication.
      security:
        - basic: []
      parameters:
        - name: id
          in: path
          required: true
          description: Identifier of the movie whose cast will be modified.
          schema:
            type: string
      requestBody:
        description: Array of cast entry IDs to remove.
        required: true
        content:
          application/json:
            schema:
              type: array
              items:
                type: integer
      responses:
        "204":
          description: Cast entries removed successfully.
  /movies/{id}/pictures/delete:
    put:
      summary: Bulk delete movie pictures
      description: Deletes multiple pictures from a movie by accepting an array of picture identifiers. Requires basic authentication.
      security:
        - basic: []
      parameters:
        - name: id
          in: path
          required: true
          description: Identifier of the movie whose pictures will be deleted.
          schema:
            type: string
      requestBody:
        description: Array of picture IDs to delete.
        required: true
        content:
          application/json:
            schema:
              type: array
              items:
                type: integer
      responses:
        "204":
          description: Pictures deleted successfully.
  /people:
    get:
      summary: List people
      description: Returns all people in the system, such as actors and directors, with basic profile information.
      responses:
        "200":
          description: List of people.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/PersonResponse"
    post:
      summary: Create people
      description: Creates one or more person records, typically representing actors, directors, or other contributors. Requires basic authentication.
      security:
        - basic: []
      requestBody:
        description: Person data to create.
        required: true
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: "#/components/schemas/PersonResponse"
      responses:
        "200":
          description: Created people.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/PersonResponse"
    put:
      summary: Update a person
      description: Updates profile information for an existing person, such as name or date of birth. Requires basic authentication.
      security:
        - basic: []
      requestBody:
        description: Updated person data.
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PersonResponse"
      responses:
        "200":
          description: Updated person record.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PersonResponse"
  /people/{id}:
    get:
      summary: Get person details
      description: Returns detailed information about a person including pictures and movie involvement as director or cast.
      parameters:
        - name: id
          in: path
          required: true
          description: Identifier of the person.
          schema:
            type: string
      responses:
        "200":
          description: Detailed person information.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PersonDetailResponse"
    delete:
      summary: Delete a person
      description: Deletes the specified person from the system, typically when cleaning up unused test or duplicate data. Requires basic authentication.
      security:
        - basic: []
      parameters:
        - name: int
          in: path
          required: true
          description: Identifier of the person to delete.
          schema:
            type: string
      responses:
        "204":
          description: Person deleted successfully.
  /people/{id}/picture/{filename}:
    get:
      summary: Download person picture
      description: Returns a picture associated with the given person, typically used to show profile images.
      parameters:
        - name: id
          in: path
          required: true
          description: Identifier of the person whose picture is requested.
          schema:
            type: string
        - name: filename
          in: path
          required: true
          description: File name of the requested picture resource.
          schema:
            type: string
      responses:
        "200":
          description: Person picture file.
          content:
            "*/*":
              schema:
                type: string
                format: binary
  /people/delete:
    put:
      summary: Bulk delete people
      description: Deletes multiple people in a single request, intended primarily for administrative cleanup tasks. Requires basic authentication.
      security:
        - basic: []
      requestBody:
        description: Array of person IDs to delete.
        required: false
        content:
          application/json:
            schema:
              type: array
              items:
                type: integer
      responses:
        "204":
          description: People deleted successfully.
  /users/register:
    post:
      summary: Register user
      description: Registers a new regular user account with credentials and profile information.
      requestBody:
        description: User registration information.
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PrivateUserResponse"
      responses:
        "200":
          description: Newly registered user with private fields.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PrivateUserResponse"
  /users/register/admin:
    post:
      summary: Register admin user
      description: Registers a new administrative user with elevated permissions. Requires basic authentication of an existing admin.
      security:
        - basic: []
      requestBody:
        description: Admin user registration data.
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PrivateUserResponse"
      responses:
        "200":
          description: Newly registered admin user.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PrivateUserResponse"
  /users/login:
    get:
      summary: Login user
      description: Authenticates a user via HTTP Basic credentials and returns basic identity and role information.
      security:
        - basic: []
      responses:
        "200":
          description: Authenticated user information.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LoginResponse"
  /users:
    get:
      summary: List users
      description: Returns all users in the system, including private fields where appropriate for administrative views. Requires basic authentication.
      security:
        - basic: []
      responses:
        "200":
          description: List of users.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/PrivateUserResponse"
  /users/{id}:
    get:
      summary: Get user by ID
      description: Returns a single user identified by ID, typically for profile or administration views. Requires basic authentication.
      security:
        - basic: []
      parameters:
        - name: id
          in: path
          required: true
          description: Identifier of the user to retrieve.
          schema:
            type: string
      responses:
        "404":
          description: User not found.
        "200":
          description: User record.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserResponse"
    delete:
      summary: Delete user
      description: Deletes a user account identified by ID, usually restricted to administrative roles. Requires basic authentication.
      security:
        - basic: []
      parameters:
        - name: id
          in: path
          required: true
          description: Identifier of the user to delete.
          schema:
            type: string
      responses:
        "403":
          description: Deletion forbidden for this user (for example, self-deletion or protected user).
components:
  schemas:
    SimulateFailuresConfig:
      type: object
      description: Configuration for simulating failures and latency in API responses.
      properties:
        failureRate:
          type: number
          description: Probability between 0 and 1 that a request will fail.
        minimumDelay:
          type: integer
          description: Minimum artificial delay in milliseconds applied to responses.
        maximumDelay:
          type: integer
          description: Maximum artificial delay in milliseconds applied to responses.
    GenreResponse:
      type: object
      description: Representation of a movie genre used for classification.
      properties:
        id:
          type: integer
          description: Unique identifier of the genre.
        name:
          type: string
          description: Human-readable name of the genre.
        description:
          type: string
          description: Optional description of the genre.
    CreateGenreRequest:
      type: object
      description: Payload for creating a new genre.
      properties:
        name:
          type: string
          description: Name of the new genre.
        description:
          type: string
          description: Optional description of the new genre.
    UpdateGenreRequest:
      type: object
      description: Payload for updating an existing genre.
      properties:
        id:
          type: integer
          description: Identifier of the genre to update.
        name:
          type: string
          description: New name of the genre.
        description:
          type: string
          description: New description of the genre.
    MovieDetailResponse:
      type: object
      description: Detailed representation of a movie including relations.
      properties:
        id:
          type: integer
          description: Unique identifier of the movie.
        title:
          type: string
          description: Title of the movie.
        synopsis:
          type: string
          description: Short textual description of the movie plot.
        genres:
          type: array
          description: Genres assigned to the movie.
          items:
            type: object
            properties:
              id:
                type: integer
              name:
                type: string
              description:
                type: string
        director:
          type: object
          description: Director of the movie including picture metadata.
          properties:
            personId:
              type: integer
            name:
              type: string
            picture:
              type: object
              properties:
                id:
                  type: integer
                mainPicture:
                  type: boolean
                filename:
                  type: string
                contentType:
                  type: string
                description:
                  type: string
        minimumAge:
          type: integer
          description: Minimum audience age rating.
        releaseDate:
          type: string
          format: date
          description: Release date of the movie in YYYY-MM-DD format.
        rating:
          type: object
          description: Aggregated rating statistics for the movie.
          properties:
            average:
              type: number
            buckets:
              type: array
              items:
                type: object
                properties:
                  rating:
                    type: integer
                  count:
                    type: integer
        pictures:
          type: array
          description: Pictures associated with the movie.
          items:
            type: object
            properties:
              id:
                type: integer
              mainPicture:
                type: boolean
              filename:
                type: string
              contentType:
                type: string
              description:
                type: string
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp for the movie record in ISO8601 format.
        updatedAt:
          type: string
          format: date-time
          description: Last update timestamp for the movie record in ISO8601 format.
        cast:
          type: array
          description: Cast members and their characters in the movie.
          items:
            type: object
            properties:
              personId:
                type: integer
              name:
                type: string
              character:
                type: string
    MovieQueryResponse:
      type: object
      description: Lightweight projection of a movie used in list views.
      properties:
        id:
          type: integer
          description: Unique identifier of the movie.
        title:
          type: string
          description: Title of the movie.
        synopsis:
          type: string
          description: Short textual description of the movie plot.
        genres:
          type: array
          items:
            type: string
        releaseDate:
          type: string
          format: date
          description: Release date of the movie in YYYY-MM-DD format.
        director:
          type: object
          properties:
            personId:
              type: integer
            name:
              type: string
            picture:
              type: object
              properties:
                id:
                  type: integer
                mainPicture:
                  type: boolean
                filename:
                  type: string
                contentType:
                  type: string
                description:
                  type: string
        mainPicture:
          type: object
          properties:
            id:
              type: integer
            mainPicture:
              type: boolean
            filename:
              type: string
            contentType:
              type: string
            description:
              type: string
        rating:
          type: number
        favorite:
          type: boolean
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp for the movie record in ISO8601 format.
        updatedAt:
          type: string
          format: date-time
          description: Last update timestamp for the movie record in ISO8601 format.
    MovieRatingResponse:
      type: object
      description: Representation of a single user rating for a movie.
      properties:
        score:
          type: integer
          description: Rating score given to the movie, typically on a fixed scale.
        comment:
          type: string
          description: Optional textual comment accompanying the score.
        author:
          type: integer
          description: Identifier of the user who submitted the rating.
    SetUserRatingRequest:
      type: object
      description: Payload used to submit or update a user rating.
      properties:
        score:
          type: integer
          description: Rating score to assign to the movie.
        comment:
          type: string
          description: Optional comment to store with the rating.
    CreateMovieRequest:
      type: object
      description: Payload for creating new movies with metadata.
      properties:
        title:
          type: string
        synopsis:
          type: string
        genres:
          type: array
          description: Array of genre IDs associated with the movie.
          items:
            type: integer
        releaseDate:
          type: string
          format: date
          description: Release date of the movie in YYYY-MM-DD format.
        directorId:
          type: integer
          description: Identifier of the director person.
        minimumAge:
          type: integer
        cast:
          type: array
          description: Cast members to associate with the movie.
          items:
            type: object
            properties:
              personId:
                type: integer
              role:
                type: string
        pictures:
          type: array
          description: Pictures to upload and associate with the movie.
          items:
            type: object
            properties:
              filename:
                type: string
              data:
                type: string
              description:
                type: string
              mainPicture:
                type: boolean
    CastMemberAssignmentRequest:
      type: object
      description: Payload describing how to assign a person as a cast member.
      properties:
        personId:
          type: integer
        role:
          type: string
    CastMemberResponse:
      type: object
      description: Representation of a cast member and character in a movie.
      properties:
        personId:
          type: integer
        name:
          type: string
        character:
          type: string
    PersonResponse:
      type: object
      description: Basic representation of a person such as actor or director.
      properties:
        id:
          type: integer
        name:
          type: string
        dateOfBirth:
          type: string
          format: date
          description: Date of birth of the person in YYYY-MM-DD format.
        picture:
          type: object
          properties:
            id:
              type: integer
            mainPicture:
              type: boolean
            filename:
              type: string
            contentType:
              type: string
            description:
              type: string
    PersonDetailResponse:
      type: object
      description: Detailed representation of a person including filmography.
      properties:
        id:
          type: integer
        name:
          type: string
        dateOfBirth:
          type: string
          format: date
          description: Date of birth of the person in YYYY-MM-DD format.
        pictures:
          type: array
          description: Pictures associated with the person.
          items:
            type: object
            properties:
              id:
                type: integer
              mainPicture:
                type: boolean
              filename:
                type: string
              contentType:
                type: string
              description:
                type: string
        directedMovies:
          type: array
          description: Movies that this person has directed.
          items:
            type: object
            properties:
              id:
                type: integer
              title:
                type: string
              releaseDate:
                type: string
                format: date
                description: Release date of the movie in YYYY-MM-DD format.
              picture:
                type: object
                properties:
                  id:
                    type: integer
                  mainPicture:
                    type: boolean
                  filename:
                    type: string
                  contentType:
                    type: string
                  description:
                    type: string
        roles:
          type: array
          description: Roles this person has played across movies.
          items:
            type: object
            properties:
              movieId:
                type: integer
              title:
                type: string
              releaseDate:
                type: string
                format: date
                description: Release date of the movie in YYYY-MM-DD format.
              character:
                type: string
    PrivateUserResponse:
      type: object
      description: Internal representation of a user including private fields.
      properties:
        id:
          type: integer
        username:
          type: string
        dateOfBirth:
          type: string
          format: date
          description: Date of birth of the user in YYYY-MM-DD format.
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp for the user record in ISO8601 format.
        updatedAt:
          type: string
          format: date-time
          description: Last update timestamp for the user record in ISO8601 format.
    LoginResponse:
      type: object
      description: Response returned after successful authentication.
      properties:
        id:
          type: integer
        username:
          type: string
        role:
          type: string
    UserResponse:
      type: object
      description: Public representation of a user without sensitive fields.
      properties:
        id:
          type: integer
        username:
          type: string
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp for the user record in ISO8601 format.
        updatedAt:
          type: string
          format: date-time
          description: Last update timestamp for the user record in ISO8601 format.
  securitySchemes:
    basic:
      type: http
      scheme: basic
      description: HTTP Basic authentication used for protected endpoints.
